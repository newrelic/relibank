---
apiVersion: chaos-mesh.org/v1alpha1
kind: StressChaos
metadata:
  name: relibank-cpu-stress-test
  namespace: relibank
  labels:
    app: relibank
    experiment-type: stress-chaos
    target-flow: cpu-stress
spec:
  mode: one
  selector:
    namespaces:
    - relibank
    labelSelectors:
      app: transaction-service
  duration: 10m
  stressors:
    cpu:
      workers: 4
      load: 80

---
apiVersion: chaos-mesh.org/v1alpha1
kind: StressChaos
metadata:
  name: relibank-high-cpu-stress
  namespace: relibank
  labels:
    app: relibank
    experiment-type: stress-chaos
    target-flow: high-cpu-stress
spec:
  mode: one
  selector:
    namespaces:
    - relibank
    labelSelectors:
      app: transaction-service
  duration: 22m
  stressors:
    cpu:
      workers: 8
      load: 100

---
apiVersion: chaos-mesh.org/v1alpha1
kind: StressChaos
metadata:
  name: relibank-memory-stress-test
  namespace: relibank
  labels:
    app: relibank
    experiment-type: stress-chaos
    target-flow: memory-stress
spec:
  mode: one
  selector:
    namespaces:
    - relibank
    labelSelectors:
      app: bill-pay-service
  duration: 10m
  stressors:
    memory:
      workers: 4
      size: 512MB

---
apiVersion: chaos-mesh.org/v1alpha1
kind: StressChaos
metadata:
  name: relibank-high-memory-stress
  namespace: relibank
  labels:
    app: relibank
    experiment-type: stress-chaos
    target-flow: high-memory-stress
spec:
  mode: one
  selector:
    namespaces:
    - relibank
    labelSelectors:
      app: bill-pay-service
  duration: 22m
  stressors:
    memory:
      workers: 8
      size: 1024MB

---
apiVersion: chaos-mesh.org/v1alpha1
kind: StressChaos
metadata:
  name: relibank-combined-stress-test
  namespace: relibank
  labels:
    app: relibank
    experiment-type: stress-chaos
    target-flow: combined-stress
spec:
  mode: one
  selector:
    namespaces:
    - relibank
    labelSelectors:
      app: transaction-service
  duration: 10m
  stressors:
    cpu:
      workers: 6
      load: 90
    memory:
      workers: 4
      size: 768MB
