apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: relibank

resources:
# Namespace
- namespaces/relibank-namespace.yaml

# Secrets and ConfigMaps
- configs/database-credentials.yaml
- configs/infrastructure-config.yaml
- configs/otel-collector-kafka-config.yaml
- configs/kafka-jmx-config.yaml
- configs/nrdot-collector-mssql-config.yaml
- configs/internal-telemetry-config.yaml

# Persistent Volume Claims
- storage/persistentvolumeclaim.yaml

# Database Deployments and Services
- databases/accounts-db-deployment.yaml
- databases/mssql-deployment.yaml

# Database Initialization Jobs
- jobs/mssql-init-deployment.yaml
- jobs/postgres-init-deployment.yaml

# Infrastructure (Kafka/Zookeeper)
- infrastructure/zookeeper-deployment.yaml
- infrastructure/kafka-deployment.yaml
- infrastructure/otel-collector-kafka-deployment.yaml
- infrastructure/nrdot-collector-mssql-deployment.yaml

# Application Services
- services/frontend-service-deployment.yaml
- services/accounts-service-deployment.yaml
- services/auth-service-deployment.yaml
- services/bill-pay-service-deployment.yaml
- services/notifications-service-deployment.yaml
- services/scheduler-service-deployment.yaml
- services/transaction-service-deployment.yaml
- services/chatbot-service-deployment.yaml
- services/scenario-service-deployment.yaml

# Chaos Mesh
- infrastructure/chaos-mesh-ingress.yaml

# Secret generators
secretGenerator:
- name: nrdot-mssql-credentials
  envs:
  - infrastructure/newrelic/nrdot-mssql.env
